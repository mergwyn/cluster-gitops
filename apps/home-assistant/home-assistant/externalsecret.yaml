---
rawResources:
  secret:
    apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    spec:
      spec:
        secretStoreRef: &store
          kind: ClusterSecretStore
          name: bitwarden
        target:
          name: "{{.Release.Name}}-secret"
          creationPolicy: Owner
          template:
            data:
              secrets.yaml: |
                emoncms_api_key: "{{`{{ .api_key }}`}}"
        dataFrom:
          - extract:
              key: emoncms_api_token

  prometheus:
    apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    spec:
      spec:
        secretStoreRef: *store
        target:
          name: "{{.Release.Name}}-prometheus"
          creationPolicy: Owner
        dataFrom:
          - extract:
              key: home_assistant_prometheus_token

  github:
    apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    spec:
      spec:
        secretStoreRef: *store
        target:
          name: "{{.Release.Name}}-github"
        dataFrom:
          - extract:
              key: github_user
