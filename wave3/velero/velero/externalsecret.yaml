---
extraObjects:
  - apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    metadata:
      name: minio-s3-conf
      labels:
        app.kubernetes.io/name: velero
    spec:
      secretStoreRef:
        kind: ClusterSecretStore
        name: bitwarden
      target:
        name: minio-s3-conf
        creationPolicy: Owner
        template:
          data:
            cloud: |
              [default]
              aws_access_key_id={{`{{.ACCESS_KEY_ID}}`}}
              aws_secret_access_key={{`{{.SECRET_ACCESS_KEY}}`}}

      dataFrom:
        - extract:
            key: minio_s3

  - apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    metadata:
      name: minio-s3
      labels:
        app.kubernetes.io/name: velero
    spec:
      secretStoreRef:
        kind: ClusterSecretStore
        name: bitwarden
      target:
        name: minio-s3
        creationPolicy: Owner
      dataFrom:
        - extract:
            key: minio_s3

  - apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    metadata:
      name: idrivee2-s3-conf
      labels:
        app.kubernetes.io/name: velero
    spec:
      secretStoreRef:
        kind: ClusterSecretStore
        name: bitwarden
      target:
        name: idrivee2-s3-conf
        creationPolicy: Owner
        template:
          data:
            cloud: |
              [default]
              aws_access_key_id={{`{{.ACCESS_KEY_ID}}`}}
              aws_secret_access_key={{`{{.SECRET_ACCESS_KEY}}`}}

      dataFrom:
        - extract:
            key: idrivee2_s3

  - apiVersion: external-secrets.io/v1
    kind: ExternalSecret
    metadata:
      name: idrivee2-s3
      labels:
        app.kubernetes.io/name: velero
    spec:
      secretStoreRef:
        kind: ClusterSecretStore
        name: bitwarden
      target:
        name: idrivee2-s3
        creationPolicy: Owner
      dataFrom:
        - extract:
            key: idrivee2_s3
